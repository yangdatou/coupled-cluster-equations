
from numpy import einsum

def gccsd_eom_ip_h1e(h1e, h2e, t1e, t2e, r1e, r2e):
    res = 0.0
    res +=    -1.000000 * einsum('ji,j->i'           , h1e.oo, r1e, optimize = False)
    res +=    -1.000000 * einsum('ja,aji->i'         , h1e.ov, r2e, optimize = False)
    res +=     0.500000 * einsum('jkia,akj->i'       , h2e.ooov, r2e, optimize = False)
    res +=    -1.000000 * einsum('ja,ai,j->i'        , h1e.ov, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('jkia,aj,k->i'      , h2e.ooov, t1e, r1e, optimize = True)
    res +=    -0.500000 * einsum('jkab,bi,akj->i'    , h2e.oovv, t1e, r2e, optimize = True)
    res +=     1.000000 * einsum('jkab,bj,aki->i'    , h2e.oovv, t1e, r2e, optimize = True)
    res +=     0.500000 * einsum('jkab,baji,k->i'    , h2e.oovv, t2e, r1e, optimize = True)
    res +=    -1.000000 * einsum('jkab,bi,aj,k->i'   , h2e.oovv, t1e, t1e, r1e, optimize = True)
    return res



from numpy import einsum

def gccsd_eom_ip_h2e(h1e, h2e, t1e, t2e, r1e, r2e):
    res = 0.0
    res +=    -1.000000 * einsum('ai,j->aij'         , h1e.vo, r1e, optimize = False)
    res +=     1.000000 * einsum('aj,i->aij'         , h1e.vo, r1e, optimize = False)
    res +=    -1.000000 * einsum('ki,akj->aij'       , h1e.oo, r2e, optimize = False)
    res +=     1.000000 * einsum('kj,aki->aij'       , h1e.oo, r2e, optimize = False)
    res +=    -1.000000 * einsum('ab,bji->aij'       , h1e.vv, r2e, optimize = False)
    res +=     1.000000 * einsum('kaji,k->aij'       , h2e.ovoo, r1e, optimize = False)
    res +=     0.500000 * einsum('klji,alk->aij'     , h2e.oooo, r2e, optimize = False)
    res +=    -1.000000 * einsum('kaib,bkj->aij'     , h2e.ovov, r2e, optimize = False)
    res +=     1.000000 * einsum('kajb,bki->aij'     , h2e.ovov, r2e, optimize = False)
    res +=     1.000000 * einsum('ki,ak,j->aij'      , h1e.oo, t1e, r1e, optimize = True)
    res +=    -1.000000 * einsum('kj,ak,i->aij'      , h1e.oo, t1e, r1e, optimize = True)
    res +=    -1.000000 * einsum('ab,bi,j->aij'      , h1e.vv, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('ab,bj,i->aij'      , h1e.vv, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('kb,ak,bji->aij'    , h1e.ov, t1e, r2e, optimize = True)
    res +=    -1.000000 * einsum('kb,bi,akj->aij'    , h1e.ov, t1e, r2e, optimize = True)
    res +=     1.000000 * einsum('kb,bj,aki->aij'    , h1e.ov, t1e, r2e, optimize = True)
    res +=    -1.000000 * einsum('kb,abji,k->aij'    , h1e.ov, t2e, r1e, optimize = True)
    res +=     1.000000 * einsum('kb,abki,j->aij'    , h1e.ov, t2e, r1e, optimize = True)
    res +=    -1.000000 * einsum('kb,abkj,i->aij'    , h1e.ov, t2e, r1e, optimize = True)
    res +=     1.000000 * einsum('klji,ak,l->aij'    , h2e.oooo, t1e, r1e, optimize = True)
    res +=    -1.000000 * einsum('kaib,bj,k->aij'    , h2e.ovov, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('kaib,bk,j->aij'    , h2e.ovov, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('kajb,bi,k->aij'    , h2e.ovov, t1e, r1e, optimize = True)
    res +=    -1.000000 * einsum('kajb,bk,i->aij'    , h2e.ovov, t1e, r1e, optimize = True)
    res +=    -1.000000 * einsum('klib,ak,blj->aij'  , h2e.ooov, t1e, r2e, optimize = True)
    res +=    -0.500000 * einsum('klib,bj,alk->aij'  , h2e.ooov, t1e, r2e, optimize = True)
    res +=     1.000000 * einsum('klib,bk,alj->aij'  , h2e.ooov, t1e, r2e, optimize = True)
    res +=    -1.000000 * einsum('klib,abkj,l->aij'  , h2e.ooov, t2e, r1e, optimize = True)
    res +=    -0.500000 * einsum('klib,ablk,j->aij'  , h2e.ooov, t2e, r1e, optimize = True)
    res +=     1.000000 * einsum('kljb,ak,bli->aij'  , h2e.ooov, t1e, r2e, optimize = True)
    res +=     0.500000 * einsum('kljb,bi,alk->aij'  , h2e.ooov, t1e, r2e, optimize = True)
    res +=    -1.000000 * einsum('kljb,bk,ali->aij'  , h2e.ooov, t1e, r2e, optimize = True)
    res +=     1.000000 * einsum('kljb,abki,l->aij'  , h2e.ooov, t2e, r1e, optimize = True)
    res +=     0.500000 * einsum('kljb,ablk,i->aij'  , h2e.ooov, t2e, r1e, optimize = True)
    res +=     1.000000 * einsum('kabc,ci,bkj->aij'  , h2e.ovvv, t1e, r2e, optimize = True)
    res +=    -1.000000 * einsum('kabc,cj,bki->aij'  , h2e.ovvv, t1e, r2e, optimize = True)
    res +=     1.000000 * einsum('kabc,ck,bji->aij'  , h2e.ovvv, t1e, r2e, optimize = True)
    res +=    -0.500000 * einsum('kabc,cbji,k->aij'  , h2e.ovvv, t2e, r1e, optimize = True)
    res +=     0.500000 * einsum('kabc,cbki,j->aij'  , h2e.ovvv, t2e, r1e, optimize = True)
    res +=    -0.500000 * einsum('kabc,cbkj,i->aij'  , h2e.ovvv, t2e, r1e, optimize = True)
    res +=    -0.500000 * einsum('klbc,acji,blk->aij', h2e.oovv, t2e, r2e, optimize = True)
    res +=     1.000000 * einsum('klbc,acki,blj->aij', h2e.oovv, t2e, r2e, optimize = True)
    res +=    -1.000000 * einsum('klbc,ackj,bli->aij', h2e.oovv, t2e, r2e, optimize = True)
    res +=    -0.500000 * einsum('klbc,aclk,bji->aij', h2e.oovv, t2e, r2e, optimize = True)
    res +=    -0.250000 * einsum('klbc,cbji,alk->aij', h2e.oovv, t2e, r2e, optimize = True)
    res +=     0.500000 * einsum('klbc,cbki,alj->aij', h2e.oovv, t2e, r2e, optimize = True)
    res +=    -0.500000 * einsum('klbc,cbkj,ali->aij', h2e.oovv, t2e, r2e, optimize = True)
    res +=     1.000000 * einsum('kb,bi,ak,j->aij'   , h1e.ov, t1e, t1e, r1e, optimize = True)
    res +=    -1.000000 * einsum('kb,bj,ak,i->aij'   , h1e.ov, t1e, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('klib,ak,bl,j->aij' , h2e.ooov, t1e, t1e, r1e, optimize = True)
    res +=    -1.000000 * einsum('klib,bj,ak,l->aij' , h2e.ooov, t1e, t1e, r1e, optimize = True)
    res +=    -1.000000 * einsum('kljb,ak,bl,i->aij' , h2e.ooov, t1e, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('kljb,bi,ak,l->aij' , h2e.ooov, t1e, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('kabc,ci,bj,k->aij' , h2e.ovvv, t1e, t1e, r1e, optimize = True)
    res +=    -1.000000 * einsum('kabc,ci,bk,j->aij' , h2e.ovvv, t1e, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('kabc,cj,bk,i->aij' , h2e.ovvv, t1e, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('klbc,ak,cl,bji->aij', h2e.oovv, t1e, t1e, r2e, optimize = True)
    res +=    -0.500000 * einsum('klbc,ak,cbji,l->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=     0.500000 * einsum('klbc,ak,cbli,j->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=    -0.500000 * einsum('klbc,ak,cblj,i->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=     1.000000 * einsum('klbc,ci,ak,blj->aij', h2e.oovv, t1e, t1e, r2e, optimize = True)
    res +=     0.500000 * einsum('klbc,ci,bj,alk->aij', h2e.oovv, t1e, t1e, r2e, optimize = True)
    res +=    -1.000000 * einsum('klbc,ci,bk,alj->aij', h2e.oovv, t1e, t1e, r2e, optimize = True)
    res +=     1.000000 * einsum('klbc,ci,abkj,l->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=     0.500000 * einsum('klbc,ci,ablk,j->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=    -1.000000 * einsum('klbc,cj,ak,bli->aij', h2e.oovv, t1e, t1e, r2e, optimize = True)
    res +=     1.000000 * einsum('klbc,cj,bk,ali->aij', h2e.oovv, t1e, t1e, r2e, optimize = True)
    res +=    -1.000000 * einsum('klbc,cj,abki,l->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=    -0.500000 * einsum('klbc,cj,ablk,i->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=     1.000000 * einsum('klbc,ck,abji,l->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=    -1.000000 * einsum('klbc,ck,abli,j->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=     1.000000 * einsum('klbc,ck,ablj,i->aij', h2e.oovv, t1e, t2e, r1e, optimize = True)
    res +=    -1.000000 * einsum('klbc,ci,ak,bl,j->aij', h2e.oovv, t1e, t1e, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('klbc,ci,bj,ak,l->aij', h2e.oovv, t1e, t1e, t1e, r1e, optimize = True)
    res +=     1.000000 * einsum('klbc,cj,ak,bl,i->aij', h2e.oovv, t1e, t1e, t1e, r1e, optimize = True)
    return res


